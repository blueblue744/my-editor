<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>CodePlay Editor (Self-Contained)</title>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="theme-color" content="#111827" />
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸš€</text></svg>" />
    <style>
      body{margin:0;overflow:hidden;background-color:#111827;touch-action:manipulation}#root,body,html{height:100%}input,textarea,button,select{font-size:14px}textarea::placeholder{color:#555;opacity:.5}.modal-overlay{background-color:rgba(0,0,0,.7);backdrop-filter:blur(2px)}::-webkit-scrollbar{width:6px;height:6px}::-webkit-scrollbar-track{background:#1e1e1e}::-webkit-scrollbar-thumb{background:#444;border-radius:3px}
      #loading-screen{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;background-color:#111827;color:white;font-family:sans-serif}
    </style>
  </head>
  <body>
    <div id="loading-screen">
      <svg class="animate-spin h-8 w-8 text-white mb-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>
      <p>Loading Libraries...</p>
    </div>
    <div id="root" class="w-screen flex flex-col" style="display: none;"></div>

    <script id="library-loader">
      // Inlined libraries will be placed here by the build process.
      // For this manual version, we will dynamically load and then execute.
      // NOTE: This approach is a workaround for the previous issues.
      // The application source is now in a separate script tag.
    </script>
    
    <!-- â˜…â˜…â˜… ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å…¨ã‚³ãƒ¼ãƒ‰ â˜…â˜…â˜… -->
    <script type="text/babel" data-presets="react,typescript" id="app-source">
      const { useState, useEffect, useRef, useMemo } = React;
      
      const Icon = ({ path, size = 18, className = "" }) => ( React.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", width: size, height: size, viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", className: className, dangerouslySetInnerHTML: { __html: path } }) );
      const Icons = { Menu: (p) => React.createElement(Icon, { ...p, path: '<line x1="3" x2="21" y1="6" y2="6"/><line x1="3" x2="21" y1="12" y2="12"/><line x1="3" x2="21" y1="18" y2="18"/>' }), Plus: (p) => React.createElement(Icon, { ...p, path: '<path d="M5 12h14"/><path d="M12 5v14"/>' }), Trash2: (p) => React.createElement(Icon, { ...p, path: '<path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/>' }), Folder: (p) => React.createElement(Icon, { ...p, path: '<path d="M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z"/>' }), File: (p) => React.createElement(Icon, { ...p, path: '<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/>' }), Code: (p) => React.createElement(Icon, { ...p, path: '<polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/>' }), Play: (p) => React.createElement(Icon, { ...p, path: '<polygon points="5 3 19 12 5 21 5 3"/>' }), List: (p) => React.createElement(Icon, { ...p, path: '<line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><line x1="3" y1="6" x2="3.01" y2="6"/><line x1="3" y1="12" x2="3.01" y2="12"/><line x1="3" y1="18" x2="3.01" y2="18"/>' }), RotateCcw: (p) => React.createElement(Icon, { ...p, path: '<path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/>' }), SelectAll: (p) => React.createElement(Icon, { ...p, path: '<path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"/>' }), Download: (p) => React.createElement(Icon, { ...p, path: '<path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" x2="12" y1="15" y2="3"/>' }), Upload: (p) => React.createElement(Icon, { ...p, path: '<path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" x2="12" y1="3" y2="15"/>' }), Archive: (p) => React.createElement(Icon, { ...p, path: '<rect width="20" height="5" x="2" y="3" rx="1"/><path d="M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8"/><path d="M10 12h4"/>' }), ChevronRight: (p) => React.createElement(Icon, { ...p, path: '<polyline points="9 18 15 12 9 6"/>' }), ChevronDown: (p) => React.createElement(Icon, { ...p, path: '<polyline points="6 9 12 15 18 9"/>' }), Github: (p) => React.createElement(Icon, { ...p, path: '<path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"/><path d="M9 18c-4.51 2-5-2-7-2"/>' }), Flash: (p) => React.createElement(Icon, { ...p, path: '<polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/>' }), Edit: (p) => React.createElement(Icon, { ...p, path: '<path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"/><path d="m15 5 4 4"/>' }), NewFolder: (p) => React.createElement(Icon, { ...p, path: '<path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/><line x1="12" x2="12" y1="11" y2="17"/><line x1="9" x2="15" y1="14" y2="14"/>' }), X: (p) => React.createElement(Icon, { ...p, path: '<path d="M18 6 6 18"/><path d="m6 6 12 12"/>' }), Refresh: (p) => React.createElement(Icon, { ...p, path: '<path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/><path d="M8 16H3v5"/>' }), Settings: (p) => React.createElement(Icon, { ...p, path: '<circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/>' }) };
      const generateId = () => Date.now().toString(36) + Math.random().toString(36).substring(2);
      const Editor = ({ file, onChange }) => { const t = useRef(null); useEffect(() => { t.current && (t.current.scrollTop = 0); }, [file?.id]); const o = () => { t.current && (t.current.focus(), t.current.select()); }; return file ? React.createElement("div", { className: "flex flex-col h-full bg-editor-bg relative group" }, React.createElement("div", { className: "flex items-center justify-between px-4 py-2 bg-editor-sidebar border-b border-editor-border shrink-0" }, React.createElement("span", { className: "text-sm font-medium text-gray-200" }, file.name), React.createElement("button", { onClick: o, className: "flex flex-col items-center justify-center p-1 text-gray-500 hover:text-white rounded hover:bg-gray-700 w-12 transition-colors", title: "å…¨é¸æŠ" }, React.createElement(Icons.SelectAll, { size: 18 }))), React.createElement("textarea", { ref: t, value: file.content, onChange: e => onChange(e.target.value), className: "flex-1 w-full bg-editor-bg text-gray-300 font-mono text-sm p-4 resize-none focus:outline-none leading-6", spellCheck: !1, autoCapitalize: "off", placeholder: "// ã“ã“ã«ã‚³ãƒ¼ãƒ‰ã‚’ãƒšãƒ¼ã‚¹ãƒˆ..." })) : React.createElement("div", { className: "flex-1 flex flex-col items-center justify-center text-gray-500 bg-editor-bg h-full" }, React.createElement(Icons.Code, { size: 48, className: "mb-4 opacity-20" }), React.createElement("p", null, "ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„")); };
      const WebContainerPreview = ({ files }) => { const [t, o] = useState(null), [n, a] = useState(!0), [i, l] = useState("Initializing..."), [s, c] = useState("about:blank"), u = useRef(!1), d = useRef(null); useEffect(() => { if (u.current || "undefined" == typeof window.WebContainer) return; u.current = !0, async function () { l("Booting WebContainer..."); try { const e = await window.WebContainer.boot(); o(e), e.on("server-ready", (e, t) => { l(`Server ready: ${t}`), c(t), a(!1); }), e.on("error", e => { l(`Error: ${e.message}`), console.error(e); }); } catch (e) { l(`Boot Error: ${e.message}`), console.error(e); } }(); }, []); const m = useRef(null); return useEffect(() => { t && files.length && (d.current && clearTimeout(d.current), d.current = setTimeout(async () => { a(!0), c("about:blank"); try { m.current && (await m.current.kill(), m.current = null), l("Writing files to virtual FS..."), await Promise.all(files.map(e => { const r = e.name.split("/"); return r.length > 1 ? t.fs.mkdir(r.slice(0, -1).join("/"), { recursive: !0 }).then(() => t.fs.writeFile(e.name, e.content)) : t.fs.writeFile(e.name, e.content); })), l('Running "npm install"...'); const e = await t.spawn("npm", ["install"]); if (e.output.pipeTo(new WritableStream({ write(e) { console.log("[NPM I]", e); } })), 0 !== await e.exit) throw new Error("npm install failed. Check console for details."); l('Running "npm run dev"...'); const r = await t.spawn("npm", ["run", "dev"]); m.current = r, r.output.pipeTo(new WritableStream({ write(e) { console.log("[VITE]", e); } })); } catch (e) { l(`Error: ${e.message}`), console.error(e), a(!1); } }, 1500)); }, [files, t]), React.createElement("div", { className: "flex flex-col h-full bg-gray-800 text-white" }, React.createElement("div", { className: "p-2 bg-gray-900 border-b border-gray-700 text-xs text-center font-mono shrink-0 h-8 flex items-center justify-center truncate" }, i), n && React.createElement("div", { className: "flex-1 flex items-center justify-center bg-gray-800" }, React.createElement("div", { className: "text-center" }, React.createElement("svg", { className: "animate-spin h-8 w-8 text-white mx-auto mb-4", xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24" }, React.createElement("circle", { className: "opacity-25", cx: "12", cy: "12", r: "10", stroke: "currentColor", strokeWidth: "4" }), React.createElement("path", { className: "opacity-75", fill: "currentColor", d: "M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z" })), React.createElement("p", { className: "font-semibold" }, "Loading Environment..."))), React.createElement("iframe", { src: s, className: `flex-1 w-full h-full border-none bg-white ${n ? "hidden" : "block"}` })); };
      const Sidebar = ({ isOpen: e, onClose: t, projects: o, onSave: n, onLoad: a, onDelete: i, onClear: l, onImportJSON: s }) => { const c = useRef(null); const u = () => { const e = new Blob([JSON.stringify(o, null, 2)], { type: "application/json" }), t = document.createElement("a"); t.href = URL.createObjectURL(e), t.download = `codeplay_backup_${(new Date).toISOString().slice(0, 10)}.json`, document.body.appendChild(t), t.click(), document.body.removeChild(t); }; const d = e => { const t = new FileReader; t.onload = e => { try { s(JSON.parse(e.target.result)), alert("å¾©å…ƒã—ã¾ã—ãŸï¼"); } catch { alert("ã‚¨ãƒ©ãƒ¼"); } }, t.readAsText(e.target.files[0]), e.target.value = ""; }; return e ? React.createElement("div", { className: "fixed inset-0 z-50 flex" }, React.createElement("div", { className: "fixed inset-0 bg-black/60 backdrop-blur-sm", onClick: t }), React.createElement("div", { className: "relative w-80 max-w-[85%] bg-gray-900 border-r border-gray-700 flex flex-col h-full shadow-2xl animate-in slide-in-from-left duration-200" }, React.createElement("div", { className: "p-4 border-b border-gray-800 flex justify-between items-center h-16" }, React.createElement("span", { className: "text-white font-bold flex gap-2 items-center" }, React.createElement(Icons.Folder, { size: 20, className: "text-blue-500" }), " ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ"), React.createElement("button", { onClick: t }, React.createElement(Icons.X, { size: 20, className: "text-gray-400" }))), React.createElement("div", { className: "p-4 space-y-3 border-b border-gray-800" }, React.createElement("button", { onClick: n, className: "w-full bg-blue-600 text-white py-2 rounded text-sm font-bold hover:bg-blue-500" }, "ä¿å­˜ã™ã‚‹"), React.createElement("div", { className: "flex gap-2" }, React.createElement("button", { onClick: u, className: "flex-1 bg-gray-800 text-gray-300 py-2 rounded text-xs flex items-center justify-center gap-1 border border-gray-700" }, React.createElement(Icons.Download, { size: 14 }), " ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—"), React.createElement("button", { onClick: () => c.current.click(), className: "flex-1 bg-gray-800 text-gray-300 py-2 rounded text-xs flex items-center justify-center gap-1 border border-gray-700" }, React.createElement(Icons.Upload, { size: 14 }), " å¾©å…ƒ"), React.createElement("input", { type: "file", ref: c, onChange: d, accept: ".json", className: "hidden" }))), React.createElement("div", { className: "flex-1 overflow-y-auto p-2 space-y-2" }, 0 === o.length && React.createElement("div", { className: "text-center text-gray-500 text-xs mt-10" }, "ä¿å­˜ã•ã‚ŒãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ã‚ã‚Šã¾ã›ã‚“"), o.map(e => React.createElement("div", { key: e.id, className: "bg-gray-800 p-3 rounded flex justify-between items-center group" }, React.createElement("div", { onClick: () => { confirm("èª­ã¿è¾¼ã¿ã¾ã™ã‹ï¼Ÿ(ç¾åœ¨ã®ç·¨é›†å†…å®¹ã¯å¤±ã‚ã‚Œã¾ã™)") && (a(e), t()); }, className: "flex-1 cursor-pointer" }, React.createElement("div", { className: "text-sm font-bold text-gray-200" }, e.name), React.createElement("div", { className: "text-xs text-gray-500" }, new Date(e.createdAt).toLocaleDateString())), React.createElement("button", { onClick: () => i(e.id), className: "text-gray-500 hover:text-red-400 p-2" }, React.createElement(Icons.Trash2, { size: 16 }))))), React.createElement("div", { className: "p-4 border-t border-gray-800" }, React.createElement("button", { onClick: l, className: "w-full text-red-500 text-xs py-2 border border-red-900/30 rounded" }, "å…¨å±¥æ­´ã‚’æ¶ˆå»")))) : null; };
      const buildFileTree = e => { const t = { name: "root", isFolder: !0, children: {}, path: "" }; return e.forEach(e => { const o = e.name.split("/"); let n = t; o.forEach((t, a) => { const i = o.slice(0, a + 1).join("/"); a === o.length - 1 ? n.children[t] = { ...e, isFolder: !1, path: e.name } : (n.children[t] || (n.children[t] = { name: t, isFolder: !0, children: {}, path: i }), n = n.children[t]); }); }), t; };
      const FileTreeNode = ({ node: e, activeFileId: t, onSelect: o, onDelete: n, onRenameFile: a, onRenameFolder: i, onDeleteFolder: l, depth: s = 0 }) => { const [c, u] = useState(!0); if (!e.isFolder) return React.createElement("div", { onClick: () => o(e.id), className: `group flex justify-between items-center py-1.5 pr-2 cursor-pointer text-sm hover:bg-gray-800 ${t === e.id ? "bg-editor-active text-white border-l-2 border-l-blue-500" : "text-gray-400 border-l-2 border-transparent"}`, style: { paddingLeft: `${12 * s + 12}px` } }, React.createElement("div", { className: "flex items-center gap-1.5 min-w-0 overflow-hidden" }, React.createElement(Icons.File, { size: 14, className: "shrink-0 opacity-70" }), React.createElement("span", { className: "truncate" }, e.name.split("/").pop())), React.createElement("div", { className: "flex opacity-0 group-hover:opacity-100 transition-opacity gap-1" }, React.createElement("button", { onClick: t => { t.stopPropagation(), a(e); }, className: "text-gray-500 hover:text-white" }, React.createElement(Icons.Edit, { size: 13 })), React.createElement("button", { onClick: t => { t.stopPropagation(), confirm(`å‰Šé™¤: ${e.name}?`) && n(e.id); }, className: "text-gray-500 hover:text-red-400" }, React.createElement(Icons.Trash2, { size: 13 })))); const d = Object.values(e.children).sort((t, o) => t.isFolder === o.isFolder ? t.name.localeCompare(o.name) : t.isFolder ? -1 : 1); return "root" === e.name ? React.createElement("div", { className: "flex flex-col" }, d.map(e => React.createElement(FileTreeNode, { key: e.path, node: e, activeFileId: t, onSelect: o, onDelete: n, onRenameFile: a, onRenameFolder: i, onDeleteFolder: l, depth: 0 }))) : React.createElement("div", { className: "flex flex-col select-none" }, React.createElement("div", { onClick: () => u(!c), className: "group flex justify-between items-center py-1.5 pr-2 cursor-pointer text-sm text-gray-300 hover:bg-gray-800 hover:text-white transition-colors", style: { paddingLeft: `${12 * s + 6}px` } }, React.createElement("div", { className: "flex items-center gap-1 min-w-0 overflow-hidden" }, React.createElement("span", { className: "p-0.5 text-gray-500" }, c ? React.createElement(Icons.ChevronDown, { size: 14 }) : React.createElement(Icons.ChevronRight, { size: 14 })), React.createElement(Icons.Folder, { size: 14, className: "shrink-0 text-blue-400" }), React.createElement("span", { className: "truncate font-medium" }, e.name)), React.createElement("div", { className: "flex opacity-0 group-hover:opacity-100 transition-opacity gap-1" }, React.createElement("button", { onClick: e => { e.stopPropagation(), i(e.path, e.name); }, className: "text-gray-500 hover:text-white" }, React.createElement(Icons.Edit, { size: 13 })), React.createElement("button", { onClick: e => { e.stopPropagation(), confirm(`å‰Šé™¤: ${e.name}?`) && l(e.path); }, className: "text-gray-500 hover:text-red-400" }, React.createElement(Icons.Trash2, { size: 13 })))), c && React.createElement("div", { className: "flex flex-col" }, d.map(e => React.createElement(FileTreeNode, { key: e.path, node: e, activeFileId: t, onSelect: o, onDelete: n, onRenameFile: a, onRenameFolder: i, onDeleteFolder: l, depth: s + 1 })))); };
      const FileExplorer = ({ files: e, activeFileId: t, onSelect: o, onAdd: n, onDelete: a, onUpload: i, onRenameFile: l, onRenameFolder: s, onDeleteFolder: c, onGitHub: u, onGenerateConfig: d }) => { const [m, p] = useState(""), [f, h] = useState(!1), g = useRef(null), b = useMemo(() => buildFileTree(e), [e]); const k = t => { t.preventDefault(), m && (n(m, "text", ""), p(""), h(!1)); }; const v = () => { const e = prompt("ãƒ•ã‚©ãƒ«ãƒ€å:"); e && n(`${e}/.keep`, "text", ""); }; const y = async () => { if (!window.JSZip) return void alert("JSZip library not loaded."); const t = new JSZip; e.forEach(e => { e.name.endsWith(".keep") || t.file(e.name, e.content); }); const o = await t.generateAsync({ type: "blob" }), n = document.createElement("a"); n.href = URL.createObjectURL(o), n.download = `project_${(new Date).getTime()}.zip`, document.body.appendChild(n), n.click(), document.body.removeChild(n); }; const w = e => { Array.from(e.target.files).forEach(e => { const t = new FileReader; t.onload = t => i(e.name, t.target.result, "text"), t.readAsText(e); }), e.target.value = ""; }; return React.createElement("div", { className: "flex flex-col h-full bg-editor-sidebar border-r border-editor-border" }, React.createElement("div", { className: "p-3 border-b border-editor-border flex flex-col gap-2 shrink-0" }, React.createElement("div", { className: "flex justify-between items-center" }, React.createElement("span", { className: "text-xs font-bold text-gray-400" }, "ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§")), React.createElement("button", { onClick: d, className: "w-full text-[10px] bg-blue-900/50 text-blue-300 border border-blue-800 py-1 rounded hover:bg-blue-800/50 flex items-center justify-center gap-1" }, React.createElement(Icons.Flash, { size: 12 }), " Viteè¨­å®šç”Ÿæˆ"), React.createElement("div", { className: "flex gap-1 justify-between pt-1" }, React.createElement("button", { onClick: u, className: "text-gray-400 hover:text-white p-1", title: "GitHubã¸ãƒ—ãƒƒã‚·ãƒ¥" }, React.createElement(Icons.Github, { size: 16 })), React.createElement("button", { onClick: y, className: "text-gray-400 hover:text-white p-1", title: "ZIPä¿å­˜" }, React.createElement(Icons.Archive, { size: 16 })), React.createElement("button", { onClick: () => g.current.click(), className: "text-gray-400 hover:text-white p-1", title: "èª­è¾¼" }, React.createElement(Icons.Upload, { size: 16 })), React.createElement("button", { onClick: v, className: "text-gray-400 hover:text-white p-1", title: "ãƒ•ã‚©ãƒ«ãƒ€ä½œæˆ" }, React.createElement(Icons.NewFolder, { size: 16 })), React.createElement("button", { onClick: () => h(!f), className: "text-gray-400 hover:text-white p-1", title: "ãƒ•ã‚¡ã‚¤ãƒ«è¿½åŠ " }, React.createElement(Icons.Plus, { size: 16 }))), React.createElement("input", { type: "file", multiple: !0, ref: g, onChange: w, className: "hidden" })), f && React.createElement("form", { onSubmit: k, className: "p-2 bg-gray-800 shrink-0 border-b border-editor-border" }, React.createElement("input", { value: m, onChange: e => p(e.target.value), className: "w-full bg-gray-900 text-white text-sm p-2 rounded outline-none border border-blue-500", placeholder: "ä¾‹: App.tsx", autoFocus: !0, onBlur: () => { m || h(!1); } })), React.createElement("div", { className: "flex-1 overflow-y-auto group" }, 0 === e.length ? React.createElement("div", { className: "p-4 text-xs text-center text-gray-600" }, "ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚Šã¾ã›ã‚“") : React.createElement(FileTreeNode, { node: b, activeFileId: t, onSelect: o, onDelete: a, onRenameFile: l, onRenameFolder: s, onDeleteFolder: c }))); };
      const GitHubModal = ({ isOpen: e, onClose: t, files: o }) => { const [n, a] = useState(localStorage.getItem("cp_gh_token") || ""), [i, l] = useState(localStorage.getItem("cp_gh_repo") || ""), [s, c] = useState(localStorage.getItem("cp_gh_branch") || "main"), [u, d] = useState(""), [m, p] = useState(!1); const f = async () => { if (!n || !i) return alert("Tokenã¨ãƒªãƒã‚¸ãƒˆãƒªåã¯å¿…é ˆã§ã™"); localStorage.setItem("cp_gh_token", n), localStorage.setItem("cp_gh_repo", i), localStorage.setItem("cp_gh_branch", s), p(!0), d("æ¥ç¶šä¸­..."); try { const e = { Authorization: `token ${n}`, Accept: "application/vnd.github.v3+json", "Content-Type": "application/json" }, t = `https://api.github.com/repos/${i}`; if (!(await fetch(t, { headers: e })).ok) throw new Error(`ãƒªãƒã‚¸ãƒˆãƒªãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: ${res.status}`); const a = o.filter(e => !e.name.endsWith(".keep")); for (const o of a) { d(`Uploading ${o.name}...`); const n = btoa(unescape(encodeURIComponent(o.content))), a = `${t}/contents/${o.name}`; let c = null; try { (await fetch(a + `?ref=${s}`, { headers: e })).ok && (c = (await (await fetch(a + `?ref=${s}`, { headers: e })).json()).sha); } catch (e) { } const u = { message: `Update ${o.name} via CodePlay`, content: n, branch: s, ...c ? { sha: c } : {} }; if (!(await fetch(a, { method: "PUT", headers: e, body: JSON.stringify(u) })).ok) throw new Error(`Failed: ${o.name}`); } d("å®Œäº†ã—ã¾ã—ãŸï¼"); } catch (e) { d("Error: " + e.message); } finally { p(!1); } }; return e ? React.createElement("div", { className: "fixed inset-0 z-[100] modal-overlay flex items-center justify-center p-4" }, React.createElement("div", { className: "bg-gray-900 border border-gray-700 rounded-lg w-full max-w-md p-6 shadow-2xl" }, React.createElement("h2", { className: "text-xl font-bold text-white mb-4 flex items-center gap-2" }, React.createElement(Icons.Github, { size: 24 }), " GitHubã¸ãƒ—ãƒƒã‚·ãƒ¥"), React.createElement("div", { className: "space-y-3" }, React.createElement("div", null, React.createElement("label", { className: "text-xs text-gray-400" }, "GitHub Token"), React.createElement("input", { value: n, onChange: e => a(e.target.value), type: "password", className: "w-full bg-gray-800 text-white p-2 rounded border border-gray-700 mt-1" })), React.createElement("div", null, React.createElement("label", { className: "text-xs text-gray-400" }, "Repo (user/repo)"), React.createElement("input", { value: i, onChange: e => l(e.target.value), className: "w-full bg-gray-800 text-white p-2 rounded border border-gray-700 mt-1" })), React.createElement("div", { className: "text-xs font-mono text-green-400 min-h-[20px]" }, u), React.createElement("div", { className: "flex justify-end gap-2 mt-2" }, React.createElement("button", { onClick: t, className: "px-4 py-2 text-sm text-gray-400" }, "é–‰ã˜ã‚‹"), React.createElement("button", { onClick: f, disabled: m, className: "px-4 py-2 text-sm bg-green-600 text-white rounded font-bold" }, m ? "..." : "Push"))))) : null; };
      const App = () => { const [e, t] = useState(() => { try { const e = localStorage.getItem("cp_files_wc"); return e ? JSON.parse(e) : []; } catch { return []; } }), [o, n] = useState(null), [a, i] = useState(!1), [l, s] = useState("files"), [c, u] = useState(window.innerWidth < 768), [d, m] = useState(!1), [p, f] = useState(() => { try { return JSON.parse(localStorage.getItem("cp_projects_wc") || "[]"); } catch { return []; } }); useEffect(() => { localStorage.setItem("cp_projects_wc", JSON.stringify(p)); }, [p]), useEffect(() => { localStorage.setItem("cp_files_wc", JSON.stringify(e)); }, [e]), useEffect(() => { const e = () => u(window.innerWidth < 768); return window.addEventListener("resize", e), () => window.removeEventListener("resize", e); }, []); const h = e => { const o = prompt("ãƒ•ã‚¡ã‚¤ãƒ«åå¤‰æ›´:", e.name); o && o !== e.name && t(t => t.map(t => t.id === e.id ? { ...t, name: o } : t)); }, g = (o, n) => { const a = prompt("ãƒ•ã‚©ãƒ«ãƒ€åå¤‰æ›´:", n); if (a && a !== n) { const n = o.substring(0, o.lastIndexOf("/")), i = n ? `${n}/${a}` : a; t(e => e.map(e => e.name.startsWith(o + "/") ? { ...e, name: e.name.replace(o, i) } : e)); } }, b = e => { t(t => t.filter(t => !t.name.startsWith(e + "/"))); }, k = o => { if (o) { const n = { id: generateId(), name: o, files: e, createdAt: Date.now() }; f(e => [n, ...e]), alert("ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä¿å­˜ã—ã¾ã—ãŸ"); } }; const v = () => { if (e.length > 0 && !confirm("Vite + Reactç”¨ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ç”Ÿæˆã—ã¾ã™ã‹ï¼Ÿ(ç¾åœ¨ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ä¸Šæ›¸ãã•ã‚Œã¾ã™)")) return; const o = [{ name: "package.json", content: JSON.stringify({ name: "vite-react-starter", private: !0, version: "0.0.0", type: "module", scripts: { dev: "vite --host", build: "tsc && vite build", preview: "vite preview" }, dependencies: { react: "^18.2.0", "react-dom": "^18.2.0" }, devDependencies: { "@types/react": "^18.2.0", "@types/react-dom": "^18.2.0", "@vitejs/plugin-react": "^4.2.0", typescript: "^5.3.0", vite: "^5.0.0", tailwindcss: "^3.4.0", postcss: "^8.4.32", autoprefixer: "^10.4.16" } }, null, 2) }, { name: "vite.config.ts", content: "import { defineConfig } from 'vite'\nimport react from '@vitejs/plugin-react'\n\nexport default defineConfig({ plugins: [react()] })" }, { name: "index.html", content: '<!DOCTYPE html>\n<html lang="en">\n  <head>\n    <meta charset="UTF-8" />\n    <meta name="viewport" content="width=device-width, initial-scale=1.0" />\n    <title>Vite App</title>\n  </head>\n  <body>\n    <div id="root"></div>\n    <script type="module" src="/src/main.tsx"></script>\n  </body>\n</html>' }, { name: "src/main.tsx", content: "import React from 'react'\nimport ReactDOM from 'react-dom/client'\nimport App from './App.tsx'\nimport './index.css'\n\nReactDOM.createRoot(document.getElementById('root')!).render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n)" }, { name: "src/App.tsx", content: 'import React from "react";\n\nexport default function App() {\n  return (\n    <div className="flex flex-col items-center justify-center min-h-screen bg-gray-900 text-white p-4 gap-4">\n      <h1 className="text-4xl font-bold text-center">Hello Vite + React!</h1>\n      <p className="text-gray-400 text-center">This is running inside a WebContainer.</p>\n    </div>\n  );\n}' }, { name: "src/index.css", content: "@tailwind base;\n@tailwind components;\n@tailwind utilities;" }, { name: "tailwind.config.js", content: "/** @type {import('tailwindcss').Config} */\nexport default {\n  content: [\"./index.html\", \"./src/**/*.{js,ts,jsx,tsx}\"],\n  theme: { extend: {} },\n  plugins: [],\n}" }, { name: "postcss.config.js", content: "export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}" }]; const a = o.map(e => ({ id: generateId(), name: e.name, content: e.content })); t(a), n(a.find(e => "src/App.tsx" === e.name)?.id); }; const y = e.find(e => e.id === o); return React.createElement("div", { className: "flex flex-col h-full text-white font-sans bg-gray-900" }, React.createElement("header", { className: "bg-editor-sidebar border-b border-editor-border p-1 flex items-center justify-between shrink-0 h-16 z-20 shadow-md" }, React.createElement("div", { className: "flex items-center gap-2 pl-1" }, React.createElement("button", { onClick: () => i(!0), className: "flex flex-col items-center justify-center p-2 text-gray-400 hover:text-white rounded hover:bg-gray-700 w-14" }, React.createElement(Icons.Menu, { size: 20 }), React.createElement("span", { className: "text-[10px] mt-0.5" }, "Menu")), React.createElement("div", { className: "flex flex-col justify-center" }, React.createElement("span", { className: "font-bold text-base tracking-tight leading-tight" }, "CodePlay"), React.createElement("span", { className: "text-[10px] text-gray-500 leading-tight" }, "Editor"))), React.createElement("div", { className: "flex items-center gap-1 pr-1" }, React.createElement("button", { onClick: () => { confirm("ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã‹ï¼Ÿ") && (t([]), n(null), localStorage.removeItem("cp_files_wc")); }, className: "flex flex-col items-center justify-center p-2 text-gray-400 hover:text-white rounded hover:bg-gray-700 w-14" }, React.createElement(Icons.RotateCcw, { size: 18 }), React.createElement("span", { className: "text-[10px] mt-0.5" }, "Reset")))), React.createElement("main", { className: "flex-1 flex overflow-hidden relative" }, React.createElement("div", { className: `${c && "files" !== l ? "hidden" : "flex"} w-full md:w-56 md:flex-none flex-col h-full z-10 border-r border-editor-border bg-editor-sidebar` }, React.createElement(FileExplorer, { files: e, activeFileId: o, onSelect: e => { n(e), c && s("editor"); }, onAdd: (o, a, i) => { t([...e, { id: generateId(), name: o, language: a, content: i || "" }]); }, onDelete: e => { t(t => t.filter(t => t.id !== e)), o === e && n(null); }, onUpload: (o, a, i) => { t(e => [...e, { id: generateId(), name: o, language: i, content: a }]); }, onRenameFile: h, onRenameFolder: g, onDeleteFolder: b, onGitHub: () => m(!0), onGenerateConfig: v })), React.createElement("div", { className: `${c && "editor" !== l ? "hidden" : "flex"} flex-1 flex-col min-w-0 md:border-r border-editor-border md:max-w-[50%]` }, React.createElement(Editor, { file: y, onChange: o => { t(e.map(t => t.id === y.id ? { ...t, content: o } : t)); } })), React.createElement("div", { className: `${c && "preview" !== l ? "hidden" : "flex"} flex-1 flex-col bg-white h-full` }, React.createElement(WebContainerPreview, { files: e }))), React.createElement("div", { className: "md:hidden h-16 bg-editor-sidebar border-t border-editor-border flex items-center justify-around shrink-0 pb-safe z-30" }, React.createElement("button", { onClick: () => s("files"), className: `flex flex-col items-center justify-center gap-0.5 w-full h-full ${"files" === l ? "text-blue-400 bg-gray-800" : "text-gray-500"}` }, React.createElement(Icons.List, { size: 20 }), React.createElement("span", { className: "text-[10px]" }, "Files")), React.createElement("button", { onClick: () => s("editor"), className: `flex flex-col items-center justify-center gap-0.5 w-full h-full ${"editor" === l ? "text-blue-400 bg-gray-800" : "text-gray-500"}` }, React.createElement(Icons.Code, { size: 20 }), React.createElement("span", { className: "text-[10px]" }, "Code")), React.createElement("button", { onClick: () => s("preview"), className: `flex flex-col items-center justify-center gap-0.5 w-full h-full ${"preview" === l ? "text-blue-400 bg-gray-800" : "text-gray-500"}` }, React.createElement(Icons.Play, { size: 20 }), React.createElement("span", { className: "text-[10px]" }, "Run"))), React.createElement(GitHubModal, { isOpen: d, onClose: () => m(!1), files: e }), React.createElement(Sidebar, { isOpen: a, onClose: () => i(!1), projects: p, onSave: () => { const e = prompt("ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå:"); e && k(e); }, onLoad: e => { t(e.files), n(e.files[0]?.id); }, onDelete: e => { f(t => t.filter(t => t.id !== e)); }, onClear: () => { confirm("å…¨å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ") && f([]); }, onImportJSON: e => { f(t => [...e, ...t]); } })); };
      
      ReactDOM.createRoot(document.getElementById('root')).render(React.createElement(App));
    </script>
  </body>
</html>
